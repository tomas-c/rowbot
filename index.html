<html>
  <head>
  	<script src="cordova.js"></script>
  	<script src="libs/evothings/evothings.js"></script>
    <script src="libs/flot/jquery.js"></script>
    <script src="libs/flot/jquery.flot.js"></script>
    <script src="libs/flot/jquery.flot.time.js"></script>    
    <script src="libs/flot/jquery.flot.axislabels.js"></script>
  </head>

  <body>
    <div id="acceleration" style="width:100%;height:30%;"></div>
    <div id="peaks" style="width:100%;height:30%;"></div>
    <script src="js/graphs.js"></script>
    <script src="js/rowbot.js"></script>
    <script>
      function initialise() {
        initialiseAccelerometer()
      }

      // Temporary code, updating the data with phone accelerometer 
      // readings
      function initialiseAccelerometer() {
        function onSuccess(acceleration) {
          var velocity = VelocityPlotter();
          velocity.update(acceleration, 0.1);
          var x = velocity.v.x, 
              y = velocity.v.y, 
              z = velocity.v.z;
          hyper.log(velocity.v.x);
          var timeNow = new Date().getTime();
          acceleration_data.push([timeNow, Math.sqrt(x*x + y*y + z*z)]);
          acceleration_data.shift();
        }

        function onError(error) {
          hyper.log('Accelerometer error: ' + error)
        }

        navigator.accelerometer.watchAcceleration(
          onSuccess,
          onError,
          { frequency: 50 })
      }
      
      document.addEventListener(
        'deviceready',
        initialise,
        false)
        hyper.log("Starting")

      updateGraph();

    </script>
  
  </body>
</html>
